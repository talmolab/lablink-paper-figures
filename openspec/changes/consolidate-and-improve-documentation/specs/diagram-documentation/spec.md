# Capability: Diagram Documentation and Usage Guide

## Overview

Provide comprehensive documentation for all 12 generated diagrams, including how to generate them, what each diagram shows, and when to use each one.

## ADDED Requirements

### Requirement: Document all 12 generated diagrams with purpose and usage

The system SHALL provide complete documentation for all 12 diagrams in the suite.

**Rationale**: Users need to understand what each diagram shows and when to use it.

#### Scenario: Create diagram reference documentation

**Given** 12 diagrams are generated by the system
**When** a user reads the diagram documentation
**Then** documentation must exist for each diagram type:
  1. lablink-architecture - Main system overview
  2. lablink-architecture-detailed - Detailed infrastructure
  3. lablink-api-architecture - 22 Flask API endpoints
  4. lablink-vm-provisioning - VM provisioning workflow
  5. lablink-crd-connection - CRD connection workflow (15 steps)
  6. lablink-logging-pipeline - CloudWatch logging pipeline
  7. lablink-database-schema - PostgreSQL schema
  8. lablink-cicd-workflow - GitHub Actions CI/CD pipeline
  9. lablink-network-flow - Network traffic flow
  10. lablink-network-flow-enhanced - Enhanced network flow
  11. lablink-monitoring - Monitoring architecture
  12. lablink-data-collection - Data collection flow
**And** each diagram must have: Purpose, Key components, When to use, Related diagrams

---

### Requirement: Provide diagram generation guide

The system SHALL provide step-by-step instructions for generating diagrams with all available options.

**Rationale**: Users need practical guide to generate diagrams for their specific use case.

#### Scenario: Document CLI usage and options

**Given** the diagram generation script supports multiple options
**When** a user reads the generation guide
**Then** it must document:
  - Basic usage: `uv run python scripts/plotting/generate_architecture_diagram.py`
  - Required argument: `--terraform-dir` pointing to lablink-template/lablink-infrastructure
  - Optional argument: `--client-vm-terraform-dir` pointing to lablink allocator Terraform
  - Diagram types: `all`, `all-essential`, `all-supplementary`, or specific type
  - Font presets: `paper` (14pt), `poster` (20pt), `presentation` (16pt)
  - Output formats: `png`, `svg`, `pdf`, `all`
  - Output directory: `figures/main/` or `figures/supplementary/`
  - Environment variables: `LABLINK_TERRAFORM_DIR`, `LABLINK_CLIENT_VM_TERRAFORM_DIR`

#### Scenario: Provide examples for common use cases

**Given** users have different output needs
**When** reading the generation guide
**Then** it must include examples for:
  - Generating all diagrams for paper: `--diagram-type all --fontsize-preset paper --format pdf`
  - Generating poster versions: `--fontsize-preset poster`
  - Generating single diagram: `--diagram-type api-architecture`
  - Using environment variables to avoid repetition

---

### Requirement: Document diagram categories and priorities

The system SHALL categorize diagrams by priority (essential vs supplementary) and explain the distinction.

**Rationale**: Help users choose which diagrams to generate for their specific needs.

#### Scenario: Document essential diagrams

**Given** diagrams are categorized by importance
**When** documentation describes essential diagrams
**Then** it must list:
  - main (architecture) - System overview
  - vm-provisioning - VM lifecycle
  - crd-connection - Unique architectural innovation
  - logging-pipeline - CloudWatch flow
**And** explain: "Essential diagrams for main paper figures"

#### Scenario: Document supplementary diagrams

**Given** supplementary diagrams provide additional detail
**When** documentation describes supplementary diagrams
**Then** it must list:
  - cicd-workflow - GitHub Actions pipeline
  - api-architecture - 22 Flask endpoints
  - network-flow-enhanced - Network topology
  - monitoring - VM health monitoring
  - data-collection - Data export flow
**And** explain: "Supplementary diagrams for appendix or detailed analysis"

---

### Requirement: Document font preset system

The system SHALL document the three font presets with their use cases and specifications.

**Rationale**: Users need to choose appropriate preset for their output medium.

#### Scenario: Document paper preset

**Given** paper preset is default for publications
**When** documentation describes paper preset
**Then** it must specify:
  - Font size: 14pt
  - Use case: "For publications, academic papers, two-column journals"
  - DPI: 300
  - Recommended format: PNG or PDF

#### Scenario: Document poster preset

**Given** poster preset is for large-format presentations
**When** documentation describes poster preset
**Then** it must specify:
  - Font size: 20pt (43% larger than paper)
  - Use case: "For conference posters, large-format printing, must be readable at distance"
  - DPI: 300
  - Recommended format: PDF

#### Scenario: Document presentation preset

**Given** presentation preset is for slides
**When** documentation describes presentation preset
**Then** it must specify:
  - Font size: 16pt
  - Use case: "For slide decks, presentations, projector display"
  - DPI: 150-300
  - Recommended format: SVG or PDF

---

### Requirement: Document output directory workflow

The system SHALL document the correct output directory usage to prevent clutter.

**Rationale**: Prevent users from creating scattered output directories that aren't tracked.

#### Scenario: Document correct output locations

**Given** diagrams should be generated to tracked locations
**When** documentation describes output workflow
**Then** it must state:
  - "ALWAYS use `--output-dir figures/main/` or `--output-dir figures/supplementary/`"
  - "Files in figures/main/ and figures/supplementary/ are committed to git"
  - "DO NOT use custom directories like test_output/ or review_figures/"
  - "Timestamped run folders (figures/run_*/) are auto-generated and gitignored"

#### Scenario: Explain timestamped run folders

**Given** timestamped folders are created automatically
**When** documentation explains this feature
**Then** it must explain:
  - "Script creates timestamped folders (e.g., figures/run_20251116_004526/) automatically"
  - "These are gitignored for temporary review"
  - "Use --no-timestamp-runs only for special cases"
  - "Final versions should be copied to figures/main/ or figures/supplementary/"

---

## MODIFIED Requirements

None. This adds new documentation without changing diagram generation.

---

## REMOVED Requirements

None. This preserves all existing functionality.

---

## Dependencies

- 12 diagram generation methods in `src/diagram_gen/generator.py`
- CLI script `scripts/plotting/generate_architecture_diagram.py`
- Generated diagrams in `figures/main/`
- Font preset system (`FONT_PRESETS`)

---

## Testing Notes

### Validation Checklist

**Diagram documentation completeness:**
- [ ] All 12 diagrams documented with purpose
- [ ] Each diagram has "When to use" guidance
- [ ] Related diagrams cross-referenced

**Generation guide completeness:**
- [ ] All CLI options documented
- [ ] Examples for common use cases provided
- [ ] Environment variables documented

**Preset documentation:**
- [ ] All 3 presets documented with specs
- [ ] Use cases clearly explained
- [ ] Recommended formats specified

**Output workflow:**
- [ ] Correct output directories documented
- [ ] Timestamped folders explained
- [ ] Best practices for file management

---

## Success Metrics

**Quantitative:**
- 12/12 diagrams documented
- 3/3 font presets documented
- â‰¥3 usage examples provided

**Qualitative:**
- User can generate any diagram type without trial-and-error
- Clear guidance on choosing font preset
- No confusion about output directories
